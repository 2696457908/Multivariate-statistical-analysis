y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
annotate(geom = 'rect',             # 方形区域
xmin = 6, xmax =10,        #
ymin = 1.2, ymax = 1.6,    # 坐标范围
fill = 'red', alpha = 0.2) + # 填充为红色，透明度为0.2
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
annotate(geom = 'rect',             # 方形区域
xmin = 6, xmax =10,        #
ymin = 1.2, ymax = 1.6,    # 坐标范围
fill = 'red', alpha = 0.2)  # 填充为红色，透明度为0.2
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
)
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
annotate(geom = 'rect',             # 方形区域
xmin = 125, xmax =130,        #
ymin = 5, ymax = 30,    # 坐标范围
fill = 'red', alpha = 0.2)  # 填充为红色，透明度为0.2
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
)
p
barplot(c(1:6),col = brewer.pal(9,"OrRd")[3:8])
p
head(df)
sample(1)
sample(1:10)
df[sample(1:nrow(df))[1], 9]
df[sample(1:nrow(df))[1], 8]
levels(df[, ncol(df)])
levels(df[, ncol(df)])[0]
levels(df[, ncol(df)])[1]
df[sample_data[1], 8] = '0'
sample_data = sample(1:nrow(df))
df[sample_data[1], 8] = '0'
df[sample_data[2], 8] = '1-9'
df[sample_data[3], 8] = "10-49"
df[sample_data[4], 8] = "50-99"
df[sample_data[5], 8] = "100-499"
df[sample_data[6], 8] = "500-999"
df[sample_data[7], 8] = "1000-4999"
df[sample_data[8], 8] = ">=5000"
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
)
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = 'dd'
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
)
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = 'dd' +
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
)
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = 'dd',
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
)
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = element_text(title = 'dd'),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
)
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = element_text('dd'),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
)
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = element_text('dd'),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
scale_fill_discrete(name="Experimental\nCondition")
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = element_text('dd'),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
guides(fill=guide_legend(title='a'))
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = element_text('dd'),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
guides(fill=guide_legend(title='累计确诊量'))
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = element_text('dd'),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
labs(fill="Condition")
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = element_text('dd'),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
guides(fill=guide_legend(title='累计确诊量'))
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = element_text('dd'),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
)
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
guides(fill=guide_legend(title='累计确诊量'))
p
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = element_text(face = 'bold')
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
guides(fill=guide_legend(title='累计确诊量'))
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = element_text(face = 'bold'),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
guides(fill=guide_legend(title='累计确诊量'))
p
covid_plot = function(china_data, daytime){
# 选择特定时期的数据
df = subset(china_data, time == daytime)
# 以group填充
p = ggplot(data = df, aes(x = long, y = lat,
group = group, fill = Group)) +
geom_polygon(colour = 'Black') +
coord_map('polyconic') +
scale_fill_brewer(palette = 'OrRd') +
# scale_color_manual(values = c("#E69F00", "#999999", 'red')) +
labs(title = '新冠疫情累计确诊',
subtitle = daytime,
x = '',
y = '') +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
plot.subtitle = element_text(face = "bold", hjust = 0.5, size = 15, color = "red"),
legend.title = element_text(face = 'bold'),
legend.text = element_text(face = "bold",color = "black"),
legend.background = element_rect(colour = "black"),
legend.key = element_rect(fill = NA),
legend.position = 'right',
panel.border = element_rect(color = "black", linetype = "solid", size = 1, fill = NA)
) +
guides(fill=guide_legend(title='累计确诊量'))
# 保存图片
ggsave(filename = paste(sep = '', daytime, '.png'),
plot = p,
path = 'C:\\Users\\xiawenjun\\Desktop\\助教\\助教\\Multivariate-statistical-analysis\\ggplot2',
width = 20, height = 20, units = 'cm')
}
covid_plot(china_data, mytime[1])
covid_plot(china_data, mytime[1])
